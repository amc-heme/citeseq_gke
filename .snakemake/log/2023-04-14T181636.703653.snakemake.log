Building DAG of jobs...
Using snakemake/snakemake:v7.25.0 for Kubernetes jobs.
Using shell: /bin/bash
Provided cloud nodes: 999
Job stats:
job                    count    min threads    max threads
-------------------  -------  -------------  -------------
all                        1              1              1
cutadapt_feature           1              3              3
starsolo_feature           1              3              3
starsolo_gex_counts        1              3              3
total                      4              1              3

Select jobs to execute...
Failed to solve scheduling problem with ILP solver. Falling back to greedy solver. Run Snakemake with --verbose to see the full solver output for debugging the problem.

[Fri Apr 14 18:16:43 2023]
rule starsolo_gex_counts:
    input: bkt-test-926/pbmc_test/data/pbmc_GEX_L001_R1_001.fastq.gz, bkt-test-926/pbmc_test/data/pbmc_GEX_L002_R1_001.fastq.gz
    output: bkt-test-926/pbmc_test/results/gex/pbmc/pbmc_Solo.out/Barcodes.stats
    log: bkt-test-926/logs/pbmc_star_gex_counts.out
    jobid: 1
    reason: Missing output files: bkt-test-926/pbmc_test/results/gex/pbmc/pbmc_Solo.out/Barcodes.stats
    wildcards: sample=pbmc
    threads: 3
    resources: mem_mb=1000, mem_mib=954, disk_mb=1000, disk_mib=954, tmpdir=<TBD>

Get status with:
kubectl describe pod snakejob-29d70d58-a86a-5b01-baa3-ee864f4a6b31
kubectl logs snakejob-29d70d58-a86a-5b01-baa3-ee864f4a6b31

[Fri Apr 14 18:16:43 2023]
rule cutadapt_feature:
    input: bkt-test-926/pbmc_test/data/pbmc_ADT_L003_R1_001.fastq.gz
    output: bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R1.fastq.gz, bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R2.fastq.gz
    log: bkt-test-926/logs/pbmc_cutadapt_adt.out
    jobid: 3
    reason: Missing output files: bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R1.fastq.gz, bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R2.fastq.gz
    wildcards: lib=adt, sample=pbmc
    threads: 3
    resources: mem_mb=1000, mem_mib=954, disk_mb=1000, disk_mib=954, tmpdir=<TBD>

Get status with:
kubectl describe pod snakejob-ac852c62-f262-5fd0-b38a-f844a0619283
kubectl logs snakejob-ac852c62-f262-5fd0-b38a-f844a0619283
[Fri Apr 14 18:17:21 2023]
Error in rule starsolo_gex_counts:
    message: For details, please issue:
kubectl describe pod snakejob-29d70d58-a86a-5b01-baa3-ee864f4a6b31
kubectl logs snakejob-29d70d58-a86a-5b01-baa3-ee864f4a6b31
    jobid: 1
    input: bkt-test-926/pbmc_test/data/pbmc_GEX_L001_R1_001.fastq.gz, bkt-test-926/pbmc_test/data/pbmc_GEX_L002_R1_001.fastq.gz
    output: bkt-test-926/pbmc_test/results/gex/pbmc/pbmc_Solo.out/Barcodes.stats
    log: bkt-test-926/logs/pbmc_star_gex_counts.out (check log file(s) for error details)
    shell:
        
      STAR --soloType CB_UMI_Simple       --soloCBmatchWLtype 1MM_multi_Nbase_pseudocounts       --soloUMIfiltering MultiGeneUMI       --soloUMIdedup 1MM_Directional       --readFilesCommand gunzip -c       --runThreadN 12       --soloBarcodeReadLength 0       --outFilterScoreMin 30       --soloCBwhitelist /ref/3M-february-2018.txt --soloUMIlen 12       --genomeDir /ref/cr2020A_star       --clipAdapterType CellRanger4       --soloFeatures Gene SJ Velocyto       --soloCellFilter EmptyDrops_CR 10000 0.99 10 45000 90000 500 0.01 20000 0.01 10000         --limitOutSJcollapsed 2000000       --outFileNamePrefix /pbmc_test/results/gex/pbmc/pbmc_       --outSAMtype None       --readFilesIn $(echo bkt-test-926/pbmc_test/data/pbmc_GEX_L001_R1_001.fastq.gz bkt-test-926/pbmc_test/data/pbmc_GEX_L002_R1_001.fastq.gz | sed 's/ /,/g;s/R1/R2/g') $(echo bkt-test-926/pbmc_test/data/pbmc_GEX_L001_R1_001.fastq.gz bkt-test-926/pbmc_test/data/pbmc_GEX_L002_R1_001.fastq.gz | sed 's/ /,/g')
      
      find /pbmc_test/results/gex/pbmc/pbmc_* -name "*tsv" -o -name '*mtx' -o -name '*tab'       | grep -v 'SJ/raw/features.tsv' | while read i; do gzip $i; done
      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    jobid: snakejob-29d70d58-a86a-5b01-baa3-ee864f4a6b31

[Fri Apr 14 18:17:42 2023]
Error in rule cutadapt_feature:
    message: For details, please issue:
kubectl describe pod snakejob-ac852c62-f262-5fd0-b38a-f844a0619283
kubectl logs snakejob-ac852c62-f262-5fd0-b38a-f844a0619283
    jobid: 3
    input: bkt-test-926/pbmc_test/data/pbmc_ADT_L003_R1_001.fastq.gz
    output: bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R1.fastq.gz, bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R2.fastq.gz
    log: bkt-test-926/logs/pbmc_cutadapt_adt.out (check log file(s) for error details)
    shell:
        
      cutadapt -j 24 -l 25         -o bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R2.fastq.gz         <(zcat $(echo bkt-test-926/pbmc_test/data/pbmc_ADT_L003_R1_001.fastq.gz | sed 's/R1/R2/g'))
      
      if [[ 1 == 1 ]]
      then
        ln -s bkt-test-926/pbmc_test/data/pbmc_ADT_L003_R1_001.fastq.gz bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R1.fastq.gz
      else
        gunzip -c bkt-test-926/pbmc_test/data/pbmc_ADT_L003_R1_001.fastq.gz | gzip -c > bkt-test-926/pbmc_test/results/cutadapt/adt/pbmc_adt_trimmed.R1.fastq.gz
      fi
      
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)
    jobid: snakejob-ac852c62-f262-5fd0-b38a-f844a0619283

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-04-14T181636.703653.snakemake.log
